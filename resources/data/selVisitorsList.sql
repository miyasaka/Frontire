SELECT
	TO_CHAR(A.LASTVISITTIME,'YYYYMMDDHH24MISS') AS LASTVISITTIME,
	A.VISITCOUNT,
	B.MID,
	B.NICKNAME,
	B.MEMBERTYPE,
	C.FRONTIERDOMAIN,
	C.FID,
	C.MID AS FMID,
	C.NICKNAME AS FNICKNAME,
		CASE 
			WHEN B.MEMBERTYPE = 0 THEN C.NICKNAME
			WHEN B.MEMBERTYPE = 1 THEN C.NICKNAME || ' [F]'
			ELSE ''
		END AS SFNICKNAME,
		CASE 
			WHEN B.MEMBERTYPE = 0 THEN C.NICKNAME
			WHEN B.MEMBERTYPE = 1 THEN C.NICKNAME || ' [' || C.FRONTIERDOMAIN || ']'
			ELSE ''
		END AS LFNICKNAME
FROM
	VISITORS AS A,
	MEMBERS AS B,
	FRONTIER_USER_MANAGEMENT C
WHERE
	A.VISITMID = /*mid*/ AND
	A.MID = B.MID AND
	A.MID = C.MID AND
	B.STATUS = '1'
ORDER BY A.LASTVISITTIME DESC
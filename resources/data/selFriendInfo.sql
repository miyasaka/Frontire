SELECT
	FUM.FRONTIERDOMAIN,
	FUM.FID,
	TO_NUMBER(SUBSTR(FUM.FID,2),'000000000') AS FIDNUM,
	MEM.MID,
	MEM.EMAIL,
	MEM.NICKNAME,
	(SELECT REGIONNM FROM MST_PREFECTURES WHERE REGIONCD = MEM.HOMETOWN_REGION) AS HOMETOWNREGION,
	(SELECT CITYNAME FROM MST_CITIES WHERE CITYCD = MEM.HOMETOWN_CITY AND REGIONCD = MEM.HOMETOWN_REGION) AS HOMETOWNCITY,
	(SELECT REGIONNM FROM MST_PREFECTURES WHERE REGIONCD = MEM.RESIDENCE_REGION) AS RESIDENCEREGION,
	(SELECT CITYNAME FROM MST_CITIES WHERE CITYCD = MEM.RESIDENCE_CITY AND REGIONCD = MEM.RESIDENCE_REGION) AS RESIDENCECITY,
	age(current_timestamp, TO_DATE(MEM.YEAROFBIRTH||MEM.DATEOFBIRTH,'YYYYMMDD')),
	SUBSTR(MEM.DATEOFBIRTH,'1','2')||'月'||SUBSTR(MEM.DATEOFBIRTH,'3','2')||'日' AS DATEOFBIRTH,
	CASE MEM.GENDER WHEN '1' THEN '男性' WHEN '2' THEN '女性' ELSE NULL END AS GENDER,
	CASE MEM.BLOODTYPE WHEN '1' THEN 'A型' WHEN '2' THEN 'B型' WHEN '3' THEN 'O型' WHEN '4' THEN 'AB型' END AS BLOODTYPE,
	(SELECT ITEMNAME FROM MST_COMITEMCODE WHERE ITEMID = 'occupation' AND ITEMCD =MEM.OCCUPATION) AS OCCUPATION,
	MEM.COMPANY,
	MEM.INTEREST1,
	MEM.ABOUTME,
	MEM.STATUS,
	MEM.ENTDATE,
	MEM.UPDID,
	MEM.UPDDATE,
	MEM.FAMILYNAME,
	MEM.NAME,
	MEM.MOBILEEMAIL,
	MEM.LASTACCESSDATE,
	MI.PUB_YEAROFBIRTH,
	MI.PUB_DATEOFBIRTH,
	MI.PUB_RESIDENCE,
	MI.PUB_HOMETOWN,
	MI.PUB_OCCUPATION,
	MI.PUB_COMPANY,
	MI.PUB_DIARY,
	MI.PUB_NAME,
	MI.PUB_GENDER,
	CASE PHOTO.MAINPICNO WHEN '1' THEN PHOTO.PIC1 WHEN '2' THEN PHOTO.PIC2 WHEN '3' THEN PHOTO.PIC3 END AS PHOTO,
	PHOTO.MAINPICNO,
	(SELECT ITEMNAME FROM MST_COMITEMCODE WHERE ITEMID = 'favorite' AND ITEMCD =MEM_ADD.FAVGENRE1) AS FAVGENRE1,
	(SELECT ITEMNAME FROM MST_COMITEMCODE WHERE ITEMID = 'favorite' AND ITEMCD =MEM_ADD.FAVGENRE2) AS FAVGENRE2,
	(SELECT ITEMNAME FROM MST_COMITEMCODE WHERE ITEMID = 'favorite' AND ITEMCD =MEM_ADD.FAVGENRE3) AS FAVGENRE3,
	MEM_ADD.FAVCONTENTS1,
	MEM_ADD.FAVCONTENTS2,
	MEM_ADD.FAVCONTENTS3,
	MEM_ADD.FAVALBUM1,
	MEM_ADD.FAVALBUM2,
	CASE WHEN A.LOGINDATE < 5 THEN '5分以内'
	WHEN A.LOGINDATE < 55 THEN (TRUNC(A.LOGINDATE/5 + .9, 0)*5)||'分以内'
	WHEN A.LOGINDATE < 60*23 THEN CEIL(A.LOGINDATE/60)||'時間以内'
	WHEN A.LOGINDATE < 60*24 THEN '1日以内'
	WHEN A.LOGINDATE < 60*72 THEN TRUNC(A.LOGINDATE/60/24)+1||'日以内'
	ELSE '3'||'日以上'
	END AS LOGINDATE,
	MEM.FOLLOWNUMBER,
	MEM.FOLLOWERNUMBER,
	MEM.MEMBERTYPE
FROM
	MEMBERITEM_INFO MI,
	FRONTIER_USER_MANAGEMENT FUM,
	MEMBERS MEM
	LEFT JOIN MEMBERPHOTO_INFO PHOTO ON  MEM.MID = PHOTO.MID
	LEFT JOIN MEMBERADD_INFO MEM_ADD ON MEM.MID = MEM_ADD.MID
	LEFT JOIN (
		SELECT
			MID,
			CASE TO_NUMBER(TO_CHAR(CURRENT_TIMESTAMP - LASTACCESSDATE,'DDD'),'99999')
				WHEN 0 THEN TO_NUMBER(TO_CHAR(CURRENT_TIMESTAMP - LASTACCESSDATE,'HH24'),'9999')*60+TO_NUMBER(TO_CHAR(CURRENT_TIMESTAMP - LASTACCESSDATE,'MI'),'99')
				ELSE TO_NUMBER(TO_CHAR(CURRENT_TIMESTAMP - LASTACCESSDATE,'DDD'),'99999')*60*24
			END AS LOGINDATE
		FROM MEMBERS
		) A ON MEM.MID = A.MID
WHERE
	MI.MID = MEM.MID AND
	FUM.MID = MEM.MID AND
	MEM.STATUS = '1' AND
	MEM.MID = /*mid*/
SELECT
  A.ANO
 ,A.TITLE
 ,A.DETAIL AS DETAILORG
 ,CASE WHEN LENGTH(A.DETAIL) > 100 THEN SUBSTR(A.DETAIL,0,101)||'・・・' ELSE A.DETAIL END AS DETAIL
 ,A.PUBLEVEL
 ,TO_CHAR(A.ENTDATE,'YYYYMMDDHH24MISS') AS ENTDATE
 ,B.PIC
 ,B.PICNAME
 ,COALESCE(C.CNT,0) AS CNT
 ,COALESCE(D.CNT,0) AS CNT2
FROM
  PHOTO_ALBUM A
  LEFT JOIN PHOTO B ON A.MID = B.MID AND A.ANO = B.ANO AND B.COVERFLG = '1' AND B.DELFLG = '0'
  LEFT JOIN (SELECT MID,ANO,COUNT(*) AS CNT
             FROM PHOTO_COMMENT
             WHERE
                  MID    = /*mid*/
              AND DELFLG = '0'
             GROUP BY MID,ANO) C ON A.MID = C.MID AND A.ANO = C.ANO
  LEFT JOIN (SELECT MID,ANO,COUNT(FNO) AS CNT
             FROM PHOTO
             WHERE
                  MID    = /*mid*/
              AND DELFLG = '0'
             GROUP BY MID,ANO) D ON A.MID = D.MID AND A.ANO = D.ANO
WHERE
     A.MID    = /*mid*/
 AND A.DELFLG = '0'
ORDER BY A.ENTDATE DESC